const { XMLParser, XMLBuilder, XMLValidator} = require("fast-xml-parser");
const axios = require('axios');
const fs = require('fs-extra')
const path = require('path')
// https://raw.githubusercontent.com/banned-historical-archives/banned-historical-archives3/main

// 当前所有patch
const patch_all = [
["00540b9d04","72d4fe45-d0bf-4ce4-afc9-ba7c7ddc6f38"],
["012898eef6","c21f8808-2334-4e60-a047-27a52e8adbce"],
["02132a6f78","0b2f26ed-ad29-48e7-9c89-446932a97ab0"],
["027df86135","35fcf895-4895-4e9c-b2be-89d0ff5aabf3"],
["05393ebbf6","0fcbbaa0-3b65-40fb-902e-678b9fd6e506"],
["06cdcecd89","c21f8808-2334-4e60-a047-27a52e8adbce"],
["072fc0caa9","799f3f6f-d8d1-4181-b6a7-9a9daaf84bb8"],
["07b9f52fbe","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["083219c452","040958d6-6657-414d-9702-8234e7c28625"],
["085c26377f","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["08eace4d1e","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["0965faf900","7e25f78e-34c8-4f74-bb66-f25361b2a16a"],
["0a9fd12bbe","c02feeb6-58b4-44b9-9965-47de5504e4b7"],
["0c37e5824a","bb264672-4652-4810-b440-516ae554b3be"],
["0d2214f349","6217a650-402c-431d-bc67-8fb48f4f35d2"],
["0dd3b9f53d","529240a1-4da4-41ce-bb7f-7646f06f2df8"],
["0e808e1633","33d26a96-67db-4a35-a4ce-d02beb985e58"],
["0f9602f91e","7c69c3ac-22a8-483f-b7ba-33fb0081f388"],
["1047c297e0","maoistlibrary"],
["125cb0bdfb","c21f8808-2334-4e60-a047-27a52e8adbce"],
["159faa4b58","93482dc4-edc3-4ce3-a6d2-960ec210656a"],
["15da70fc65","dcd0d64f-fa58-4455-a6ce-8c78a1f187d0"],
["1639e68f3f","58499299-cef2-4f20-ad14-90703cd2431a"],
["166bba2746","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["16d4db9aa5","3f502324-0a16-4470-b3fc-3e237f39b604"],
["174926127d","6959f089-922d-4677-b3cb-eba8636787d0"],
["196ff43093","79570b44-6e88-4875-8247-b408ad91873d"],
["1be5fece58","a13a4008-5f3a-4f1d-8e0b-940a1c633cd5"],
["1be72b8879","9206ecb2-3e0a-458f-be99-98532260fd27"],
["1bfc3a58f3","67b43734-d924-48ac-9e62-359edd11e690"],
["1bff707f2e","c21f8808-2334-4e60-a047-27a52e8adbce"],
["1dddefec44","eaefb094-86e6-4c5f-a190-46818d16ffa2"],
["1df4d74c46","96cdc4a4-0b09-4d57-8277-6dbcbcf6e4e0"],
["1e2c20fa48","eb1072b3-9057-4142-8fd8-544053ced488"],
["1fef0c4492","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["2021410326","bb264672-4652-4810-b440-516ae554b3be"],
["226dc7756c","7a1ea3a9-d3ab-4cfe-a417-9cbb73dbc318"],
["22f56983f5","c21f8808-2334-4e60-a047-27a52e8adbce"],
["240398ce32","5c2a93f5-a845-42ca-aeb7-69a6f92fc954"],
["24309c0748","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["2530a498ee","a13a4008-5f3a-4f1d-8e0b-940a1c633cd5"],
["2630f01443","77a422f8-fc82-4e56-87e4-a6fbd48de6b8"],
["265e7d288a","wanghongwen"],
["2815d3800e","96cdc4a4-0b09-4d57-8277-6dbcbcf6e4e0"],
["28190c9108","7e25f78e-34c8-4f74-bb66-f25361b2a16a"],
["284443fc57","93482dc4-edc3-4ce3-a6d2-960ec210656a"],
["287605b910","306f36e6-2329-42e8-92d9-ed3f6faad595"],
["290cdcf90e","317dfc36-b5df-4092-b9e9-6c1e0c3c0585"],
["294d302d96","b0d92e3c-d75b-447f-8e3d-6a80bda133b3"],
["2a26dc9a86","9000310e-2f60-4711-a81d-a8fd520f6db7"],
["2a2a629963","8e9cdddb-b1bb-4984-b926-e8d5725a19da"],
["2b988c6f86","8c1a5316-884e-465a-9775-48338f6cc6b5"],
["2bd98a5e3a","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["2c7c5427f3","c21f8808-2334-4e60-a047-27a52e8adbce"],
["2cdc29a7ba","78256f65-d15b-4800-976e-d4a9e6e7a160"],
["2e8f9c7d98","0f85f67b-fe32-425f-91d4-613f3126705c"],
["2ed8d2917d","ca52d8a2-4eb3-4da5-b1db-ceebcbf032d2"],
["2eea1974a6","a13a4008-5f3a-4f1d-8e0b-940a1c633cd5"],
["2f0cf537b4","c934174f-a1b9-4f8c-8b7b-c18b3a9b1746"],
["2f3420f118","7492dacf-eac4-45d3-aecb-6184761f1139"],
["2fb4ef77c1","c21f8808-2334-4e60-a047-27a52e8adbce"],
["31151daf75","255cf4cb-cd67-45ab-b5e8-8240fdbad8f8"],
["331e8e0bdf","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["345f59038f","06439682-30be-43c0-8fc3-fcd67fd66bec"],
["35d202b499","097e8dc4-78a1-46bb-8b7e-467bb84632b7"],
["37b77e717f","0a1132cb-3f4d-4852-aa99-4c5410428503"],
["37e112daad","5551106b-99c0-496b-af47-d8335692e6ca"],
["37f4ed5a60","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["3a35850e5f","0fcbbaa0-3b65-40fb-902e-678b9fd6e506"],
["3b69bc3ca3","c4f4035b-486a-459b-9cb7-4deb00350052"],
["3b71febb1a","2cec027f-70be-4525-8a87-8da2e7cfa6fc"],
["3b79a3cd3d","58499299-cef2-4f20-ad14-90703cd2431a"],
["3d56bd28eb","72a130d0-a36b-4b75-8e93-f35bf6ff8176"],
["3f6567124c","becd9f73-f6d4-4f1a-88ac-2fb3b1dfbffa"],
["41e72af627","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["43ddb76b09","1ce721bb-e004-4708-a437-dde2f92a1a98"],
["46812d8b99","1a64a4ed-2bab-4ea1-8b71-c280caca4767"],
["478c60f1a8","b8cb3468-7dc6-4668-87e8-4fceb1f91d3d"],
["48ee960c84","eaefb094-86e6-4c5f-a190-46818d16ffa2"],
["49966f91eb","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["4d4762e5dd","ba649341-ec2e-4344-bb21-ba1d35fd1cd7"],
["4faccda6bf","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["511524124c","d4e5bc82-4b7e-437b-89ae-e720f47d3d82"],
["51209808bc","b9f56fef-aba0-4aed-990f-7e07f337ce38"],
["5202e55cdb","c21f8808-2334-4e60-a047-27a52e8adbce"],
["52bae9b3c6","7c69c3ac-22a8-483f-b7ba-33fb0081f388"],
["53df6db6c1","0c621503-01d4-4b8f-9cf2-f405bbb14ad9"],
["58371fa5d6","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["595c59228e","af3e9ad5-8eb6-487c-b6ae-b39d0a3657c4"],
["5961e48355","7c69c3ac-22a8-483f-b7ba-33fb0081f388"],
["5a3ad10ad5","af3e9ad5-8eb6-487c-b6ae-b39d0a3657c4"],
["5b9e082b3a","b8cb3468-7dc6-4668-87e8-4fceb1f91d3d"],
["5bd407c191","787c5af3-10c9-40fd-bd3e-6e0a13e7e67c"],
["5c355924c8","0fcbbaa0-3b65-40fb-902e-678b9fd6e506"],
["5dc385075e","c02feeb6-58b4-44b9-9965-47de5504e4b7"],
["5e847030a3","8c1a5316-884e-465a-9775-48338f6cc6b5"],
["5f38d9f953","93482dc4-edc3-4ce3-a6d2-960ec210656a"],
["60422e41f0","a13a4008-5f3a-4f1d-8e0b-940a1c633cd5"],
["645c3a0df4","7c69c3ac-22a8-483f-b7ba-33fb0081f388"],
["647611d6a3","c814e28a-6a5d-435e-b402-3c375ab69c97"],
["6713632486","77a422f8-fc82-4e56-87e4-a6fbd48de6b8"],
["68ea932355","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["6a68742048","8da1b3f4-a862-487f-9c7a-af20178846c8"],
["6caab7976b","0fb5b8d7-6378-4332-9016-a8c17ebf7b99"],
["6cbfd5701d","2b76c2fb-c46b-4bc2-a9e7-14a3e76e265e"],
["6d11ba7ca3","78256f65-d15b-4800-976e-d4a9e6e7a160"],
["6d8561a972","040958d6-6657-414d-9702-8234e7c28625"],
["6d9f344e1d","a47145ad-1032-4d7f-837c-4df8e1fc64be"],
["6e41b3497b","255cf4cb-cd67-45ab-b5e8-8240fdbad8f8"],
["6e6d8426fc","ae5ca463-4e1f-4a97-ba6c-b3c1123005fa"],
["6ee60dfa56","2b0f3a68-1cdd-4494-b122-3ed9cb3cb0b7"],
["6f39d01012","a13a4008-5f3a-4f1d-8e0b-940a1c633cd5"],
["71e4fd2914","a13a4008-5f3a-4f1d-8e0b-940a1c633cd5"],
["73b525893b","c21f8808-2334-4e60-a047-27a52e8adbce"],
["73e31d17f9","7c69c3ac-22a8-483f-b7ba-33fb0081f388"],
["74072ed691","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["74b3f45562","6f37606f-a3d5-47bb-b957-b2fa6bcf72fe"],
["75afad09c5","0fcbbaa0-3b65-40fb-902e-678b9fd6e506"],
["7895d509df","040958d6-6657-414d-9702-8234e7c28625"],
["7e45b077f2","a47145ad-1032-4d7f-837c-4df8e1fc64be"],
["7ea8403d46","0fcbbaa0-3b65-40fb-902e-678b9fd6e506"],
["7f56a1160f","4487f711-d1dc-4c33-a1a9-50a1b7f7d659"],
["812f4e2009","d65f2d46-f659-4061-83b6-ab5386ac2dba"],
["83944ee9b1","d7255791-fc0e-4d11-9391-b5a8c1d3cf8b"],
["83aa265aca","db61721a-a96f-4ecf-8ec8-dc3d9be7de1d"],
["83b5d055e4","0e9d4097-18bc-4064-a098-6fff10cfaa85"],
["855482cfcd","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["8635a3370d","b99cafbf-6442-4c20-bd92-45f37dbfdcff"],
["875aee71e2","0fcbbaa0-3b65-40fb-902e-678b9fd6e506"],
["87b5856683","78256f65-d15b-4800-976e-d4a9e6e7a160"],
["8918c529c2","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["8925822e81","f4596d80-d0b2-4349-91d5-aadaae94aa11"],
["892803838f","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["898af2a8de","78256f65-d15b-4800-976e-d4a9e6e7a160"],
["8d476cf42f","6217a650-402c-431d-bc67-8fb48f4f35d2"],
["8f151f1eb3","6217a650-402c-431d-bc67-8fb48f4f35d2"],
["907ec593b2","eaefb094-86e6-4c5f-a190-46818d16ffa2"],
["909c4275ad","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["92170aa422","e51c3cd5-f427-4fce-ad75-da87f2df5195"],
["927b8110c9","52d8fbe4-965f-4cfc-872b-e6029e3f734d"],
["92bbab67dd","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["95f4b20391","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["962e9ef936","b1848c1e-baa9-49fd-abc4-a8b263e4bcf6"],
["983b34d5fa","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["989defd994","097e8dc4-78a1-46bb-8b7e-467bb84632b7"],
["99c50d9fa6","c21f8808-2334-4e60-a047-27a52e8adbce"],
["9bad730367","8c1a5316-884e-465a-9775-48338f6cc6b5"],
["9eda2a2278","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["9f2aa3de09","bb264672-4652-4810-b440-516ae554b3be"],
["9f8b27233a","097e8dc4-78a1-46bb-8b7e-467bb84632b7"],
["9fb9891c85","c02feeb6-58b4-44b9-9965-47de5504e4b7"],
["a00c295fba","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["a04b76bfad","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["a0d554825c","c21f8808-2334-4e60-a047-27a52e8adbce"],
["a2140ab918","c21f8808-2334-4e60-a047-27a52e8adbce"],
["a24d68139e","a6fd5977-6216-489a-b746-2fe7689a04d4"],
["a4bfecf4ba","d65f2d46-f659-4061-83b6-ab5386ac2dba"],
["a6a9611ec8","097e8dc4-78a1-46bb-8b7e-467bb84632b7"],
["a7dc518fd0","c814e28a-6a5d-435e-b402-3c375ab69c97"],
["a9615aa901","c21f8808-2334-4e60-a047-27a52e8adbce"],
["ab2dc643f4","7492dacf-eac4-45d3-aecb-6184761f1139"],
["ac10482c21","255cf4cb-cd67-45ab-b5e8-8240fdbad8f8"],
["aca5314d5d","6217a650-402c-431d-bc67-8fb48f4f35d2"],
["b15e59e210","8e6be60c-f1a8-4eb9-9d55-43449ad516cc"],
["b1a5848048","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["b1abf6deaf","af3e9ad5-8eb6-487c-b6ae-b39d0a3657c4"],
["b238e3c3d0","c748a5f5-0b62-433b-b425-a3295b905902"],
["b261949817","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["b33a136bda","c21f8808-2334-4e60-a047-27a52e8adbce"],
["b5310d676d","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["b683a52afd","6379476a-690e-41d6-9202-58881bad8576"],
["b70af711f1","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["b973a5dba6","7bbe94bc-b48d-4d7b-b4a6-1325d0b0a2d3"],
["ba715b31ec","9ee7a157-a1ac-450b-b7a3-3c22a9c29eb3"],
["ba919839cd","259053b8-c23b-40e9-95d0-63476a3bc6c8"],
["bac9755f54","f4596d80-d0b2-4349-91d5-aadaae94aa11"],
["bb4e279f43","c21f8808-2334-4e60-a047-27a52e8adbce"],
["bbe00fb624","c21f8808-2334-4e60-a047-27a52e8adbce"],
["bbe9938aaf","49dfa82c-62bd-4241-88af-8941e04cabee"],
["bd154e214c","8c1a5316-884e-465a-9775-48338f6cc6b5"],
["c0826be659","ef0a79bf-0527-4dc3-b978-07f6d4d0d79b"],
["c1a4c8a436","cf7e2b8e-9249-4aa3-b0f4-2707aa6e74b0"],
["c3e4ddd8e8","c748a5f5-0b62-433b-b425-a3295b905902"],
["c3ea6557a3","f4596d80-d0b2-4349-91d5-aadaae94aa11"],
["c44f8cd85c","0b2f26ed-ad29-48e7-9c89-446932a97ab0"],
["c4d7f58156","maoistlibrary"],
["c601c5713c","a05b0c2f-7584-4f45-a93d-1bc287752315"],
["c6ae3dc18d","5af91bc2-3540-46ef-824e-c1e2158c6255"],
["c738027a14","93482dc4-edc3-4ce3-a6d2-960ec210656a"],
["c8d776ef37","8d98ee74-15ee-4e9a-a255-e5997a8a5bde"],
["c8fb944c88","becd9f73-f6d4-4f1a-88ac-2fb3b1dfbffa"],
["c9edfff6db","af3e9ad5-8eb6-487c-b6ae-b39d0a3657c4"],
["ca139341ec","e4beec83-82d8-42b2-845d-fe2f8c163d3d"],
["ca9946d96a","9172bd1f-5918-4850-820a-b229e2d89b8f"],
["cb76c08819","5a790475-01ac-4334-9941-63d3ee59c46c"],
["cba62b6275","78596687-074b-4839-9152-44d820015582"],
["cd7e99c22c","7c69c3ac-22a8-483f-b7ba-33fb0081f388"],
["d00699db05","0fcbbaa0-3b65-40fb-902e-678b9fd6e506"],
["d271861983","82069f34-dd44-417e-ba98-b17129bb637c"],
["d32490eb96","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["d3a4a113e5","d4e5bc82-4b7e-437b-89ae-e720f47d3d82"],
["d4a8f863ac","c21f8808-2334-4e60-a047-27a52e8adbce"],
["d52815ad69","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["d6296c8d86","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["d6bd93f854","b3ca39f5-3154-4c20-8f01-d8ed821d5ea5"],
["d734ad7096","097e8dc4-78a1-46bb-8b7e-467bb84632b7"],
["d734ad7096","d1679abc-409f-4eb4-b575-22371b9682c3"],
["d99367b97f","c02feeb6-58b4-44b9-9965-47de5504e4b7"],
["d99367b97f","febb7416-870c-4ca2-85c1-00de96d8a9d0"],
["da951e12cf","097e8dc4-78a1-46bb-8b7e-467bb84632b7"],
["dc8f6648a2","68d2d72e-cdc1-4871-8acb-fc644774b5e3"],
["dd266d1a63","bd33de67-6641-49bc-a820-870b3a2aa3df"],
["e030e46571","05553c80-edc7-44da-9c04-763802e9f833"],
["e046309460","963e343d-3662-444a-8c27-1a886eb70f7e"],
["e10188e5bf","2e2e3766-4530-464b-882c-f8b079a63e66"],
["e1bc6b40a0","a13a4008-5f3a-4f1d-8e0b-940a1c633cd5"],
["e2795325c4","5717249f-0249-47cf-9d87-0f960ce7d4b3"],
["e32b77bb90","ff8206e9-00e6-42aa-bd57-a36d2faa5e49"],
["e3b10f4d57","d5aa4730-b778-49c2-af22-093b61025603"],
["e3db4cd3ad","c02feeb6-58b4-44b9-9965-47de5504e4b7"],
["e59aba56ea","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["e63adda3c9","416aed01-110d-4f35-af13-f44ee4d11ec3"],
["e71b2f7f0e","c02feeb6-58b4-44b9-9965-47de5504e4b7"],
["e7c40dc0f2","fc38e16e-2075-408b-8a68-e00d7c7fe76f"],
["e8c01ec676","c21f8808-2334-4e60-a047-27a52e8adbce"],
["e999576925","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["ebbd40899e","f750c865-cb15-4c03-98b2-aad6e569d88a"],
["ebce5a559b","187473e3-da31-44f3-95e9-8b7b89c95627"],
["ebd19b62ab","93482dc4-edc3-4ce3-a6d2-960ec210656a"],
["edc22f6668","f692a8bf-a640-4079-89e3-c41186cb50ff"],
["edff2d1084","2ac69c65-449e-40a6-b06a-0d62772ab71d"],
["ee02d85483","0fcbbaa0-3b65-40fb-902e-678b9fd6e506"],
["f0184d529d","097e8dc4-78a1-46bb-8b7e-467bb84632b7"],
["f085041b0d","c21f8808-2334-4e60-a047-27a52e8adbce"],
["f11dfe93b2","c21f8808-2334-4e60-a047-27a52e8adbce"],
["f2e93e484e","a47145ad-1032-4d7f-837c-4df8e1fc64be"],
["f3b27ad6e2","c3e84977-6102-42ff-bc79-3e7ceacfead1"],
["f3b658c76b","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["f3e4253e8f","c814e28a-6a5d-435e-b402-3c375ab69c97"],
["f53b8acfb0","92a9726b-e187-4276-b399-71f6383e4d2d"],
["f6a7fc44d4","c21f8808-2334-4e60-a047-27a52e8adbce"],
["f6c6a5928e","c21f8808-2334-4e60-a047-27a52e8adbce"],
["f7408441ae","77f8d60b-66c4-8b3d-7488-ffdedc1e6fd2"],
["f856186973","d65f2d46-f659-4061-83b6-ab5386ac2dba"],
["f957fbeaf3","306f36e6-2329-42e8-92d9-ed3f6faad595"],
["f9ff6bc124","24ce30a0-4265-4ad5-8743-fc952385a77b"],
["fad6e92245","77a5187e-cc3e-4dc5-a41f-1e3679fd8495"],
["fcdc4d9bbf","96cdc4a4-0b09-4d57-8277-6dbcbcf6e4e0"],
["fe8bab5ccd","d36737e2-811c-4b1d-9c2c-8889eade960c"]
];

const bracket_left = '〔';
const bracket_right = '〕';
(async () => {
    async function get_pub_details(prefix, aid, pub_id) {
        const url = `${prefix}${aid}`;
        console.log(url)
        const {data} = await axios.get(url);
        const parser = new XMLParser();
        let jObj = parser.parse(data);
        const s = JSON.parse(typeof jObj.html.body.script == 'string' ? jObj.html.body.script : jObj.html.body.script[1]);
        // contents: {index, text, type}[], comments: {index, offset, part_index,text,}[]
        return s.props.pageProps.publication_details[pub_id];
    }
    for (const [aid, pub_id] of patch_all) {
        const old_details = await get_pub_details('https://banned-historical-archives.github.io/articles/', aid, pub_id);
        const new_details = await get_pub_details('http://localhost:3000/articles/', aid, pub_id);
        // console.log(old_details, new_details);
        // 创建 patch；删除所有段落和注释；插入新的段落和注释
        const patch = `export default [
  ${JSON.stringify({
    version: 2,
    parts: old_details.contents.reduce((m, i) => {
        m[i.index] = {delete: true, ...i.index === 0? {
            insertAfter: new_details.contents.sort((a,b) => a.index - b.index).map(i => {
                const text_arr = Array.from(i.text);
                new_details.comments.filter(k => k.part_index == i.index).sort((a, b) => b.offset - a.offset).forEach(k => {
                    text_arr.splice(k.offset, 0, `${bracket_left}${k.index}${bracket_right}`)
                });
                return {
                    type: i.type, text: text_arr.join('')
                }
            }),
        }: {}}
        return m;
    }, {}),
    comments: old_details.comments.filter(i => i.index != -1).reduce((m, i) => {
        m[i.index] = {delete: true};
        return m;
    }, {}),
  })},
  ${JSON.stringify({
    version: 2,
    parts: {},
    description: new_details.comments.find(i => i.index == -1)?.text || '',
    comments: {},
    newComments: new_details.comments.filter(i => i.index != -1),
  })},
]`
        await fs.writeFile(path.join(__dirname, `../patch/articles/[${aid}][${pub_id}].ts`), patch);
    }
})()